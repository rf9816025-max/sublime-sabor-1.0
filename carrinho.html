<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Carrinho - Sublime Sabor üç¨</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #ffcc70, #ff9a8b);
      color: #333;
      text-align: center;
      min-height: 100vh;
      margin: 0;
      padding: 0;
    }

    .logo {
      width: 120px;
      display: block;
      margin: 30px auto 10px auto;
    }

    .container {
      max-width: 480px;
      background: #d192ff;
      color: white;
      margin: 20px auto;
      padding: 25px;
      border-radius: 20px;
      box-shadow: 0 0 20px rgba(0,0,0,0.2);
      position: relative;
      overflow: hidden;
    }

    h2 { margin-bottom: 20px; }

    ul { list-style: none; padding: 0; text-align: left; }
    li { margin: 8px 0; background: rgba(255,255,255,0.1); padding: 10px; border-radius: 10px; }

    .total { margin-top: 15px; font-weight: bold; }

    .btn {
      display: block;
      width: 100%;
      margin-top: 12px;
      padding: 12px;
      border: none;
      border-radius: 25px;
      background: linear-gradient(90deg, #ffb3ec, #ff70b8);
      color: white;
      font-size: 1em;
      cursor: pointer;
      transition: 0.3s;
    }

    .btn:hover {
      background: linear-gradient(90deg, #ff70b8, #ffb3ec);
    }

    .pix-box {
      background: rgba(255, 255, 255, 0.15);
      padding: 15px;
      border-radius: 12px;
      margin-top: 20px;
      text-align: center;
    }

    .pix-key { font-weight: bold; font-size: 1.1em; color: #fff; }

    .mensagem-sucesso {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.8);
      background: rgba(255, 255, 255, 0.95);
      color: #5b1fa6;
      padding: 25px;
      border-radius: 20px;
      box-shadow: 0 0 20px rgba(0,0,0,0.3);
      font-size: 1.3em;
      display: none;
      z-index: 10;
    }

    /* Modal Frete */
    #modal-frete {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      align-items: center;
      justify-content: center;
      z-index: 999;
    }

    .frete-conteudo {
      background: white;
      color: #5b1fa6;
      padding: 25px;
      border-radius: 18px;
      max-width: 400px;
      text-align: center;
      box-shadow: 0 8px 25px rgba(0,0,0,0.3);
    }

    .frete-conteudo input {
      width: 100%;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid #ccc;
      margin-top: 10px;
    }
  </style>
</head>

<body>
  <img src="imagens/logo1.png" alt="Logo Sublime Sabor" class="logo">

  <div class="container">
    <h2>üõçÔ∏è Seu Carrinho</h2>
    <ul id="lista-carrinho"></ul>
    <p class="total" id="total"></p>

    <div class="pix-box">
      <p>üí∏ <strong>Pagamento via PIX</strong></p>
      <p class="pix-key" id="pixKey">kevilynwenderson12@gmail.com</p>
      <button class="btn" id="copiarPix">üìã Copiar Chave PIX</button>
    </div>

    <button class="btn" id="btnFrete">üöö Calcular Frete</button>
    <p id="resultadoFrete"></p>

    <button class="btn" id="finalizar">‚úÖ Finalizar Pedido via WhatsApp</button>
    <button class="btn" id="esvaziar">üóëÔ∏è Esvaziar Carrinho</button>
    <button class="btn" onclick="voltar()">‚¨ÖÔ∏è Voltar √† Tela Principal</button>

    <div class="mensagem-sucesso" id="mensagemSucesso">
      ‚úÖ Pedido realizado com sucesso!<br>Obrigado pela prefer√™ncia üíú
    </div>
  </div>

  <!-- Modal do Frete -->
  <div id="modal-frete">
    <div class="frete-conteudo">
      <h3>üöö Calcular Frete</h3>
      <p>Digite o endere√ßo completo:</p>
      <input type="text" id="endereco" placeholder="Rua, Bairro, Cidade...">
      <button class="btn" id="calcularFrete">Calcular</button>
      <button class="btn" id="fecharFrete">Fechar</button>
      <p id="resultado-frete"></p>
    </div>
  </div>

  <script>
    const lista = document.getElementById('lista-carrinho');
    const total = document.getElementById('total');
    const copiarPix = document.getElementById('copiarPix');
    const pixKey = document.getElementById('pixKey');
    const finalizar = document.getElementById('finalizar');
    const esvaziar = document.getElementById('esvaziar');
    const mensagemSucesso = document.getElementById('mensagemSucesso');
    const modalFrete = document.getElementById('modal-frete');
    const btnFrete = document.getElementById('btnFrete');
    const resultadoFrete = document.getElementById('resultadoFrete');

    let carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];
    let valorFrete = 0;
    let enderecoCliente = '';

    function atualizarCarrinho() {
      lista.innerHTML = '';
      let soma = 0;

      if (carrinho.length === 0) {
        lista.innerHTML = '<p>Seu carrinho est√° vazio üò¢</p>';
        total.textContent = '';
        return;
      }

      carrinho.forEach(item => {
        const precoNum = parseFloat(item.preco.replace('R$', '').replace(',', '.'));
        soma += precoNum;

        const li = document.createElement('li');
        li.textContent = `${item.nome} (${item.sabor}) - ${item.preco}`;
        lista.appendChild(li);
      });

      let totalComFrete = soma + valorFrete;
      total.textContent = `üí∞ Total: R$ ${totalComFrete.toFixed(2).replace('.', ',')}`;
    }

    function voltar() {
      window.location.href = 'index.html';
    }

    copiarPix.addEventListener('click', () => {
      navigator.clipboard.writeText(pixKey.textContent);
      copiarPix.textContent = '‚úÖ Copiado!';
      setTimeout(() => copiarPix.textContent = 'üìã Copiar Chave PIX', 1500);
    });

    esvaziar.addEventListener('click', () => {
      if (confirm('Tem certeza que deseja esvaziar o carrinho?')) {
        localStorage.removeItem('carrinho');
        carrinho = [];
        valorFrete = 0;
        resultadoFrete.textContent = '';
        atualizarCarrinho();
      }
    });

    finalizar.addEventListener('click', () => {
      if (carrinho.length === 0) return alert('Seu carrinho est√° vazio!');

      let texto = 'üç¨ *Pedido Sublime Sabor* üç¨%0A%0A';
      carrinho.forEach(item => texto += `‚Ä¢ ${item.nome} (${item.sabor}) - ${item.preco}%0A`);
      texto += `%0Aüöö *Frete:* R$ ${valorFrete.toFixed(2).replace('.', ',')}%0A`;
      if (enderecoCliente) texto += `üè† *Endere√ßo:* ${enderecoCliente}%0A`;
      texto += `üí∞ *Total:* ${total.textContent.replace('üí∞ Total: ', '')}%0A%0Aüìé Enviaremos ap√≥s o comprovante PIX.%0AChave PIX: kevilynwenderson12@gmail.com`;

      window.open(`https://wa.me/5531998345514?text=${texto}`, '_blank');

      mensagemSucesso.style.display = 'block';
      localStorage.removeItem('carrinho');
      carrinho = [];
      atualizarCarrinho();
      setTimeout(() => mensagemSucesso.style.display = 'none', 3000);
    });

    // --- Sistema de Frete ---
    btnFrete.addEventListener('click', () => modalFrete.style.display = 'flex');
    document.getElementById('fecharFrete').addEventListener('click', () => modalFrete.style.display = 'none');

    document.getElementById('calcularFrete').addEventListener('click', () => {
      const endereco = document.getElementById('endereco').value.trim();
      if (!endereco) return alert('Por favor, digite o endere√ßo.');

      enderecoCliente = endereco.toLowerCase();
      const bairro = enderecoCliente;

      const distancias = {
        'nossa senhora de lourdes': 0,
        'cana√£': 3.8,
        'durval de barros': 5.5,
        's√£o pedro': 2.0,
        'palmeiras': 6.5,
        'serra dourada': 8.2,
        'jardim industrial': 9.5
      };

      const distancia = distancias[bairro] || 4.5;
      let frete = 0;

      if (distancia <= 2.5) frete = 6;
      else if (distancia <= 4.5) frete = 7;
      else if (distancia <= 8) frete = 10;
      else frete = 15;

      valorFrete = frete;
      resultadoFrete.textContent = `üöö Frete: R$ ${frete.toFixed(2)}`;
      modalFrete.style.display = 'none';
      atualizarCarrinho();
    });

    atualizarCarrinho();
  </script>
</body>
</html>
